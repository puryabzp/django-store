{% load static %}


<nav class="navbar navbar-expand-lg navbar-light nav_bar d-flex justify-content-between" style="position: sticky;position: -webkit-sticky;position: -webkit-sticky;
    position: sticky;
    top: 0;z-index: 1;">

      <div>
{#      <form method="post" action="{% url "create_basket" %}" style="display: inline">#}
{#          {% csrf_token %}#}
{#          <input type="hidden" value="{{ user.email }}" name="user">#}
{#          {% if basket %}#}
{#               <button class="basket" type="submit" ><i class="fas fa-shopping-basket" style="color: crimson"></i></button>#}
{#           {% else %}#}
{#              <button class="basket" type="submit" ><i class="fas fa-shopping-basket"></i></button>#}
{#          {% endif %}#}
{##}
{#      </form>#}

          <div class="dropdown" style="display: inline">
                <button class="basket btn buttons dropdown-toggle mt-3 mr-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="create_basket()" style="font-size: 15px" ><i class="fas fa-shopping-basket"></i></button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="sabad" style="height: auto; width: 330px">
                    <button class="btn btn-primary ml-4" onclick="delete_basket()" style="font-size: 10px">حذف سبد خرید</button>
                    {% for basket_item in basket_items %}
                        <div style="text-align: center">
                        <span class="ml-2 mr-2">{{ basket_item.shop_product.product.title }}</span>
                        <span>{{ basket_item.price }}</span>
                        <span>{{ basket_item.count }}</span>
                        <img src="{{ basket_item.shop_product.product.image.url }}" style="width: 70px;height: 70px">
                        </div>
                    {% endfor %}


                </div>
          </div>

        <span class="m-2">|</span>
          {% if user.is_authenticated %}

              <button class="login_btn"><a href="{% url 'logout' %}" style="color: black;text-decoration: none;text-align: center;font-weight: bold">خروج از حساب کاربری</a> <i class="fas fa-user"></i></button>
          {% else %}
              <button class="login_btn"><a href="{% url 'login' %}" style="color: black;text-decoration: none;text-align: center;font-weight: bold">ورود به حساب کاربری</a> <i class="fas fa-user"></i></button>
          {% endif %}

      </div>
         <div class="d-flex">
          <div style="margin-top: 20px;">
            <form>
              <button class="search_btn"><i class="fas fa-search " style="color: gray;font-size: 10px;text-align: right;"></i></button>
              <input type="text" class="search_field" placeholder="... جستجو کن ">
            </form>

          </div>
          <div class="m-2">

              <a href="{% url 'home' %}">
                  <img src="https://s2.coinmarketcap.com/static/img/coins/200x200/3957.png" style="height: 50px;width: 50px;">
              </a>
        </div>
      </div>
    </nav>






    <div class="row w-100 p-0 m-0 cat_div mr-2 mb-1 d-flex justify-content-around">
      <div class="dropdown mt-2">
        <button class="btn buttons dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i id="button" class="fa fa-list-alt" aria-hidden="true"></i> دسته بندی ها</button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="dropdowns">
            {% for category in categories %}
                 <a class="dropdown-item" href="{% url 'categories_product' category.slug%}" style="font-weight: bold">{{ category.category_name }}</a>

{#                 <a class="dropdown-item" href="#">{{ category.category_name }}</a>#}
            {% endfor %}
        </div>
      </div>

      <div class="dropdown mt-2">
        <button class="btn buttons dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-store"></i> فروشگاه ها</button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          {% for shop in shops %}
                 <a class="dropdown-item" href="{% url 'shops_product' shop.slug%}">{{ shop.name }}</a>
            {% endfor %}
        </div>
      </div>


      <div class="dropdown mt-2">
        <button class="btn buttons dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-tags"></i> برندها</button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          {% for brand in brands %}
                 <a class="dropdown-item" href="{% url 'brands_product' brand.slug%}">{{ brand.brand_name }}</a>
            {% endfor %}
        </div>
      </div>


      <button class="btn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-size: 10px;"><i class="far fa-question-circle"></i> سوالی دارید</button>
    </div>

{% block javascript %}
<script>
    function create_basket() {
             $.ajax({
                    type: 'post',
                    data:{'user':''},
                    url: "{% url 'create_basket' %}",
                    success: function (response) {

                        const data = JSON.parse(response)
                        console.log(data)



                    }
                });
        }






    function delete_basket() {
         $.ajax({
                type: 'post',
                data:{'user':''},
                url: "{% url 'delete_basket' %}",
                success: function (response) {
                    console.log(response)


                }
            });
    }


</script>
{% endblock %}




{#                        var i;#}
{#                        for (i = 0; i < data.length; i++) {#}
{#                            $("#sabad").prepend(`<span>yesss</span>`)#}
{#                        }#}